function wfu_Initialize_Consts(e){if("undefined"==typeof GlobalData.consts){GlobalData.consts=new Object;for(var a=e.split(";"),t=0;t<a.length;t++)const_txt=a[t].split(":"),GlobalData.consts[wfu_plugin_decode_string(const_txt[0])]=wfu_plugin_decode_string(const_txt[1])}}function wfu_plugin_load_action(e){wfu_install_unload_hook();var a=document.getElementById("selectsubdiredit_"+e);a&&"none"!=a.style.display&&wfu_attach_element_handlers(a,new Function("wfu_selectsubdiredit_change("+e+");"))}function wfu_install_unload_hook(){window.onbeforeunload=wfu_unload_hook}function wfu_unload_hook(){return""!=GlobalData.UploadInProgressString&&""!=GlobalData.UploadInProgressString.trim()?GlobalData.consts.wfu_pageexit_prompt:void 0}function wfu_Check_Browser_Capabilities(){if("undefined"==typeof wfu_BrowserCaps){wfu_BrowserCaps=new Object;var e=wfu_GetHttpRequestObject();wfu_BrowserCaps.supportsAJAX=null!=e,wfu_BrowserCaps.supportsUploadProgress=!!(e&&"upload"in e&&"onprogress"in e.upload);var a=null;try{var a=new FormData}catch(t){}wfu_BrowserCaps.supportsHTML5=null!=a;var t=document.createElement("iframe");wfu_BrowserCaps.supportsIFRAME=null!=t,wfu_BrowserCaps.supportsDRAGDROP=window.FileReader?!0:!1,wfu_BrowserCaps.supportsAnimation=wfu_check_animation(),wfu_BrowserCaps.supportsFileChunking=window.File&&(window.File.prototype.slice||window.File.prototype.mozSlice||window.File.prototype.webkitSlice?!0:!1),wfu_BrowserCaps.isSafari=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0}}function wfu_check_animation(){var e=!1,a="animation",t="",s="Webkit Moz O ms Khtml".split(" "),l="",r=document.createElement("DIV");if(r.style.animationName&&(e=!0),e===!1)for(var n=0;n<s.length;n++)if(void 0!==r.style[s[n]+"AnimationName"]){l=s[n],a=l+"Animation",t="-"+l.toLowerCase()+"-",e=!0;break}return e}function wfu_join_strings(e){for(var a=[].slice.call(arguments),t="",s="",l=1;l<a.length;l++)s=""==t||""==a[l]?"":e,t+=s+a[l];return t}function wfu_plugin_decode_string(e){for(var a,t,s=0,l="";s<e.length;)a=parseInt(e.substr(s,2),16),t=128>a?a:224>a?((31&a)<<6)+(63&parseInt(e.substr(s+=2,2),16)):((15&a)<<12)+((63&parseInt(e.substr(s+=2,2),16))<<6)+(63&parseInt(e.substr(s+=2,2),16)),l+=String.fromCharCode(t),s+=2;return l}function wfu_plugin_encode_string(e){var a=0,t="",s="";for(a=0;a<e.length;a++)num=e.charCodeAt(a),num>=2048?num=((16773120&num|917504)<<4)+((4032&num|8192)<<2)+(63&num|128):num>=128&&(num=((65472&num|12288)<<2)+(63&num|128)),s=num.toString(16),(1==s.length||3==s.length||5==s.length)&&(s="0"+s),t+=s;return t}function wfu_randomString(e){for(var a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",t=e,s="",l=0;t>l;l++){var r=Math.floor(Math.random()*a.length);s+=a.substring(r,r+1)}return s}function wfu_addEventHandler(e,a,t){e.addEventListener?e.addEventListener(a,t,!1):e.attachEvent?e.attachEvent("on"+a,t):e["on"+a]=t}function wfu_attach_element_handlers(e,a){for(var t=["DOMAttrModified","textInput","input","change","keypress","paste","focus","propertychange"],s=0;s<t.length;s++)wfu_addEventHandler(e,t[s],a)}function wfu_GetHttpRequestObject(){var e=null;try{e=new XMLHttpRequest}catch(a){try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}}}if(null==e&&window.createRequest)try{xmlhttp=window.createRequest()}catch(a){}return e}function wfu_filedetails_showhide(e,a,t){var s=(document.getElementById("wfu_messageblock_arrow_"+e+"_"+a),document.getElementById("wfu_messageblock_arrow_"+e+"_up_"+a)),l=document.getElementById("wfu_messageblock_arrow_"+e+"_down_"+a),r=document.getElementById("wfu_messageblock_subheader_"+e+"_"+a),n=document.getElementById("wfu_messageblock_header_"+e+"_state_"+a);t?(s.style.display="",l.style.display="none",r.style.display="",n.value=""):(s.style.display="none",l.style.display="",r.style.display="none",n.value="none")}function wfu_get_file_ids(e){for(var a=(document.getElementById("wfu_messageblock_"+e),document.getElementById("wfu_messageblock_subheader_"+e).nextSibling),t="wfu_messageblock_"+e+"_",s=[];null!=a;)1===a.nodeType&&a.id.substr(0,t.length)==t&&s.push(a.id.substr(a.id.lastIndexOf("_")+1)),a=a.nextSibling;return s}function wfu_get_filelist(e,a){a="undefined"!=typeof a?a:!0;var t=document.getElementById("upfile_"+e),s=t.files;return s||(s=t.value?[{name:t.value}]:[]),a&&"undefined"!=typeof t.filearray&&(s=t.filearray),s}function wfu_filedetails_toggle(e,a){var t=(document.getElementById("wfu_messageblock_arrow_"+e+"_"+a),document.getElementById("wfu_messageblock_arrow_"+e+"_up_"+a));wfu_filedetails_showhide(e,a,"none"==t.style.display)}function wfu_headerdetails_showhide(e,a){var t=(document.getElementById("wfu_messageblock_arrow_"+e),document.getElementById("wfu_messageblock_arrow_"+e+"_up")),s=document.getElementById("wfu_messageblock_arrow_"+e+"_down"),l=document.getElementById("wfu_messageblock_subheader_"+e),r=document.getElementById("wfu_messageblock_subheader_"+e+"_message"),n=document.getElementById("wfu_messageblock_subheader_"+e+"_adminmessage"),o=document.getElementById("wfu_messageblock_header_"+e+"_state"),i=wfu_get_file_ids(e);if(a){t.style.display="",s.style.display="none",("none"!=r.style.display||"none"!=n.style.display)&&(l.style.display=""),o.value="";for(var _=0;_<i.length;_++)document.getElementById("wfu_messageblock_"+e+"_"+i[_]).style.display="",document.getElementById("wfu_messageblock_subheader_"+e+"_"+i[_]).style.display=document.getElementById("wfu_messageblock_header_"+e+"_state_"+i[_]).value}else{t.style.display="none",s.style.display="",l.style.display="none",o.value="none";for(var _=0;_<i.length;_++)document.getElementById("wfu_messageblock_"+e+"_"+i[_]).style.display="none",document.getElementById("wfu_messageblock_subheader_"+e+"_"+i[_]).style.display="none"}}function wfu_headerdetails_toggle(e){var a=(document.getElementById("wfu_messageblock_arrow_"+e),document.getElementById("wfu_messageblock_arrow_"+e+"_up"));wfu_headerdetails_showhide(e,"none"==a.style.display)}function wfu_filelist_showhide(e,a){var t=document.getElementById("filelist_"+e+"_totalprogress");if(t){var s=document.getElementById("filelist_"+e+"_totalprogress_arrow_up"),l=document.getElementById("filelist_"+e+"_totalprogress_arrow_down"),r=document.getElementById("filelist_"+e+"_list_div");a?(s.style.display="",l.style.display="none",t.style.borderBottom="1px solid #999999",r.style.display="block"):(s.style.display="none",l.style.display="",t.style.borderBottom="1px solid #333333",r.style.display="none")}}function wfu_filelist_toggle(e){var a=document.getElementById("filelist_"+e+"_totalprogress");if(a){var t=document.getElementById("filelist_"+e+"_totalprogress_arrow_up");wfu_filelist_showhide(e,"none"==t.style.display)}}function wfu_filelist_removeall(e){var a=document.getElementById("filelist_confirm_clearlist_"+e);if(a){var t=confirm(a.value);1==t&&(document.getElementById("uploadform_"+e).reset(),wfu_selectbutton_changed(e,0),wfu_update_uploadbutton_status(e))}}function wfu_filelist_removefile(e,a){var t=document.getElementById("upfile_"+e);"undefined"!=typeof t.filearray&&(t.filearray.splice(a,1),t.filearrayprops.splice(a,1),wfu_update_filelist(e),wfu_update_filename_text(e),wfu_update_uploadbutton_status(e))}function wfu_filelist_clear(e){document.getElementById("uploadform_"+e).reset();var a=document.getElementById("upfile_"+e);"undefined"!=typeof a.filearray&&(a.filearray.length=0,a.filearrayprops.length=0),wfu_update_filelist(e),wfu_update_filename_text(e),wfu_update_uploadbutton_status(e)}function wfu_update_filelist(e){var a=document.getElementById("upfile_"+e),t=wfu_get_filelist(e),s=document.getElementById("upload_"+e);if(s){var l=document.getElementById("upload_"+e+"_default").value,r=document.getElementById("upload_"+e+"_singular").value,n=document.getElementById("upload_"+e+"_plural").value;s.value=1==t.length?r:t.length>1?n:l}var o=document.getElementById("filelist_"+e+"_itemhtml"),i=document.getElementById("filelist_"+e+"_itemhtmlempty");if(o){var _=wfu_plugin_decode_string(o.value),d="",u="",c=0;if("undefined"==typeof a.filearray&&t.length>0?(document.getElementById("filelist_"+e+"_totalprogress").className="file_filelist_totalprogress_div_with_remove",document.getElementById("filelist_"+e+"_totalprogress_arrow").className="file_filelist_totalprogress_arrow_with_remove",document.getElementById("filelist_"+e+"_totalprogress_removeall").style.display="block"):(document.getElementById("filelist_"+e+"_totalprogress").className="file_filelist_totalprogress_div",document.getElementById("filelist_"+e+"_totalprogress_arrow").className="file_filelist_totalprogress_arrow",document.getElementById("filelist_"+e+"_totalprogress_removeall").style.display="none"),0==t.length)u=wfu_plugin_decode_string(i.value),wfu_filelist_showhide(e,!1);else{for(var m=0;m<t.length;m++)c=m+1,d=_.replace(/\[id\]/g,c),d=d.replace(/\[fileid\]/g,m),d=d.replace("[name]",t[m].name),"undefined"==typeof a.filearray?(d=d.replace("[additional class]",""),d=d.replace("[removebutton visibility]",' style="display:none;"')):(d=d.replace("[additional class]","_with_remove"),d=d.replace("[removebutton visibility]","")),u+=d;wfu_filelist_showhide(e,!0)}document.getElementById("filelist_"+e+"_list_div").innerHTML=u}}function wfu_selectbutton_changed(e,a){wfu_BrowserCaps.supportsAJAX&&wfu_BrowserCaps.supportsHTML5||(a=0);var t=document.getElementById("upfile_"+e),s=wfu_get_filelist(e,!1);if(1==a){"undefined"==typeof t.filearray&&(t.filearray=Array(),t.filearrayprops=Array());for(var l=0;l<s.length;l++)t.filearray.push(s[l]),t.filearrayprops.push({from:"dialog"})}else"undefined"!=typeof t.filearray&&(delete t.filearray,delete t.filearrayprops);wfu_update_filename_text(e),wfu_update_filelist(e)}function wfu_selectbutton_clicked(e){var a=document.getElementById("wordpress_file_upload_message_"+e);a&&(a.style.display="none"),wfu_reset_message(e),document.getElementById("upfile_"+e).value="";var t=document.getElementById("fileName_"+e);t&&(t.value="",t.className="file_input_textbox")}function wfu_update_uploadbutton_status(e){var a=document.getElementById("upload_"+e);if(a){var t=wfu_get_filelist(e),s=t.length>0,l=document.getElementById("captcha_"+e+"_empty_overlay"),r=document.getElementById("captchainput_"+e).value;s=s&&(!l||""!=r),a.disabled=!s}}function wfu_update_filename_text(e){var a=document.getElementById("fileName_"+e);if(a){for(var t=wfu_get_filelist(e),s="",l=0;l<t.length;l++)""!=s&&(s+=", "),s+=t[l].name.replace(/c:\\fakepath\\/i,"");a.value=s}}function wfu_selectsubdir_check(e){var a=document.getElementById("selectsubdir_"+e);if(!a)return!0;var t=document.getElementById("selectsubdiredit_"+e),s="none"!=t.style.display;return s&&a.selectedIndex>0&&(t.value=a.value.replace(/^\s+/,""),t.className="file_item_clean_match subfolder_autoplus_match",wfu_selectsubdiredit_change(e)),document.getElementById("hiddeninput_"+e).value=s?t.value:a.selectedIndex,!s&&0==a.selectedIndex||s&&(""==t.value||"file_item_clean_empty subfolder_autoplus_empty"==t.className)?(s?(a.className="subfolder_autoplus_dropdown_prompt",t.value="",GlobalData.FreeChangeHandler=!0,t.className="file_item_clean_prompt subfolder_autoplus_prompt",GlobalData.FreeChangeHandler=!1):a.className="file_item_clean_prompt subfolder_dropdown_prompt",!1):(a.className=s?"subfolder_autoplus_dropdown":"file_item_clean subfolder_dropdown",s&&"file_item_clean_prompt subfolder_autoplus_prompt"==t.className&&(t.className="file_item_clean subfolder_autoplus"),a.options[0].style.display="none",!0)}function wfu_selectsubdiredit_enter(e){var a=document.getElementById("selectsubdir_"+e),t=document.getElementById("selectsubdiredit_"+e);"file_item_clean_empty subfolder_autoplus_empty"==t.className&&(t.value=""),a.className="subfolder_autoplus_dropdown",t.className="file_item_clean subfolder_autoplus"}function wfu_selectsubdiredit_exit(e){var a=document.getElementById("selectsubdiredit_"+e);""==a.value&&(a.value=GlobalData.consts.wfu_subdir_typedir,a.className="file_item_clean_empty subfolder_autoplus_empty")}function wfu_selectsubdiredit_change(e){if(!GlobalData.FreeChangeHandler){var a=document.getElementById("selectsubdir_"+e),t=document.getElementById("selectsubdiredit_"+e);if("none"!=t.style.display){if("file_item_clean_empty subfolder_autoplus_empty"==t.className)return a.selectedIndex=0,void(document.getElementById("hiddeninput_"+e).value="");document.getElementById("hiddeninput_"+e).value=t.value;for(var s,l=!1,r=1;r<a.options.length;r++)s=a.options[r].value.replace(/^\s+/,"").toLowerCase(),a.options[r].style.display=t.value.length>=3?s.substr(0,t.value.length)==t.value.toLowerCase()?"block":"none":"block",a.options[r].value.replace(/^\s+/,"")==t.value&&(a.selectedIndex=r,t.className="file_item_clean_match subfolder_autoplus_match",l=!0);l||(a.selectedIndex=0,t.className="file_item_clean subfolder_autoplus")}}}function wfu_selectsubdir_disable_onoff(e,a){var t=document.getElementById("selectsubdir_"+e);if(!t)return!0;var s=document.getElementById("selectsubdiredit_"+e),l="none"!=s.style.display;t.disabled=a,l&&(s.disabled=a)}function wfu_userdata_focused(e){var a=document.getElementById(e.id.replace("_field_","_fieldwrapper_"));if("file_userdata_fieldwrapper_required_empty"==a.className){a.className="file_userdata_fieldwrapper_required";var t=document.getElementById(e.id.replace("_field_","_hint_"));t.style.display="none"}}function wfu_Redirect(e){window.location=e}function wfu_loadStart(){}function wfu_uploadProgress(e,a,t,s){s&&"undefined"==typeof this.xhr&&(console.log("total="+e.total+", loaded="+e.loaded),console.log(e));var l=GlobalData[a].xhrs[t],r=0,n=0,o=document.getElementById("progressbar_"+a+"_animation");if(l.chunk_id>0){if(0==l.file_id)return;var i=new Date;GlobalData[a].chunkedfile[l.file_id-1].lasttime[l.chunk_id-1]=i.getTime()}var _=document.getElementById("filelist_"+a+"_totalprogress_animation");if(e.lengthComputable){if(l.sizeloaded=e.loaded,l.size<e.total&&e.total>0){n=e.total-l.size,l.deltasize+=n,l.size+=n;for(var d=0;d<GlobalData[a].xhrs.length;d++)GlobalData[a].xhrs[d].file_id==l.file_id&&(GlobalData[a].xhrs[d].totalsize+=n)}if(_){for(var u=0,c=0,d=0;d<GlobalData[a].xhrs.length;d++)GlobalData[a].xhrs[d].file_id==l.file_id&&(u=Math.max(GlobalData[a].xhrs[d].totalsize,u),c+=GlobalData[a].xhrs[d].sizeloaded);for(var m=-1,d=0;d<GlobalData[a].xhrs.length;d++)if(GlobalData[a].xhrs[d]==l){m=d;break}s&&console.log("i="+m+", size="+l.size+", totalsize="+l.totalsize+", delta="+n+", total="+u+", loaded="+c),r=Math.round(100*c/u),document.getElementById("filelist_"+a+"_fileprogress_animation"+l.file_id)&&(document.getElementById("filelist_"+a+"_fileprogress_animation"+l.file_id).style.width=r.toString()+"%"),u=0,c=0;for(var f=[],d=0;d<GlobalData[a].xhrs.length;d++)f[GlobalData[a].xhrs[d].file_id]=0;for(var d=0;d<GlobalData[a].xhrs.length;d++)f[GlobalData[a].xhrs[d].file_id]=Math.max(GlobalData[a].xhrs[d].totalsize,f[GlobalData[a].xhrs[d].file_id]);for(var d=0;d<f.length;d++)"undefined"!=typeof f[d]&&(u+=f[d]);for(var d=0;d<GlobalData[a].xhrs.length;d++)c+=GlobalData[a].xhrs[d].sizeloaded;r=Math.round(100*c/u),_.style.width=r.toString()+"%"}if(o){for(var u=0,c=0,f=[],d=0;d<GlobalData[a].xhrs.length;d++)f[GlobalData[a].xhrs[d].file_id]=0;for(var d=0;d<GlobalData[a].xhrs.length;d++)f[GlobalData[a].xhrs[d].file_id]=Math.max(GlobalData[a].xhrs[d].totalsize,f[GlobalData[a].xhrs[d].file_id]);for(var d=0;d<f.length;d++)"undefined"!=typeof f[d]&&(u+=f[d]);for(var d=0;d<GlobalData[a].xhrs.length;d++)c+=GlobalData[a].xhrs[d].sizeloaded;r=Math.round(100*c/u),o.style.width=r.toString()+"%"}}else _&&(_.style.width="0%"),o&&(o.style.width="0%")}function wfu_notify_WPFilebase(e,a){var t=wfu_GetHttpRequestObject();if(null==t){var s=document.createElement("iframe");return s.style.display="none",s.src=GlobalData.consts.ajax_url+"?action=wfu_ajax_action_notify_wpfilebase&params_index="+e+"&session_token="+a,void document.body.appendChild(s)}var l=GlobalData.consts.ajax_url;params=new Array(3),params[0]=new Array(2),params[0][0]="action",params[0][1]="wfu_ajax_action_notify_wpfilebase",params[1]=new Array(2),params[1][0]="params_index",params[1][1]=e,params[2]=new Array(2),params[2][0]="session_token",params[2][1]=a;for(var r="",s=0;s<params.length;s++)r+=(s>0?"&":"")+params[s][0]+"="+encodeURI(params[s][1]);t.open("POST",l,!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.onreadystatechange=function(){},t.send(r)}function wfu_send_email_notification(e,a,t,s,l,r,n,o,i){var _=wfu_GetHttpRequestObject();if(null!=_){var d=GlobalData.consts.ajax_url,u=wfu_get_userdata_count(e);params=new Array(7+u),params[0]=new Array(2),params[0][0]="action",params[0][1]="wfu_ajax_action_send_email_notification",params[1]=new Array(2),params[1][0]="params_index",params[1][1]=t,params[2]=new Array(2),params[2][0]="session_token",params[2][1]=s,params[3]=new Array(2),params[3][0]="only_filename_list",params[3][1]=l,params[4]=new Array(2),params[4][0]="target_path_list",params[4][1]=r,params[5]=new Array(2),params[5][0]="attachment_list",params[5][1]=n,params[6]=new Array(2),params[6][0]="uniqueuploadid_"+e,params[6][1]=a;for(var c=0;u>c;c++)params[7+c]=new Array(2),params[7+c][0]="userdata_"+c,params[7+c][1]=wfu_plugin_encode_string(document.getElementById("hiddeninput_"+e+"_userdata_"+c).value);for(var m="",c=0;c<params.length;c++)m+=(c>0?"&":"")+params[c][0]+"="+encodeURI(params[c][1]);var f=new Date;_.xhrid=-1,_.shortcode_id=e,_.requesttype="email",_.file_id=0,_.loading=!1,_.aborted=!1,_.unique_id=a,_.debugmode=o,_.is_admin=i,_.chunk_id=0,_.params_index=t,_.session_token=s,_.start_time=f.getTime(),_.end_time=_.start_time,_.finish_time=_.start_time+1e3*parseInt(GlobalData.consts.max_time_limit),_.fail_colors=GlobalData.consts.fail_colors,_.error_message_header="",_.error_message_failed=GlobalData.consts.message_failed,_.error_message_cancelled=GlobalData.consts.message_cancelled,_.error_adminmessage_unknown="",_.open("POST",d,!0),_.setRequestHeader("Content-type","application/x-www-form-urlencoded"),_.addEventListener("load",wfu_uploadComplete,!1),_.addEventListener("error",wfu_uploadFailed,!1),_.addEventListener("abort",wfu_uploadCanceled,!1),_.send(m)}}function wfu_format_debug_data(e,a){return output='<label class="file_messageblock_subheader_debugmessage_label">',output+="Debug Data"+a,output+="</label>",output+='<div class="file_messageblock_subheader_debugmessage_container">',output+=e,output+="</div>"}function wfu_uploadComplete(e){var a=new Date,t=this.shortcode_id,s=this.file_id,l=!1,r="",n="",o="",i="unknown",_="",d="",u="wfu_fileupload_success:";this.loading=!1,this.end_time=a.getTime();var c=e.target.responseText,m=c,f="error";if(-1!=c&&c.indexOf("force_errorabort_code")>-1&&(f="errorabort",c=c.replace("force_errorabort_code","")),-1!=c){var p=c.indexOf(u);if(p>-1&&("true"==this.debugmode&&(d=c.substr(0,p)),m=c.substr(p+u.length),p=m.indexOf(":"),r=m.substr(0,p),m=m.substr(p+1),p=m.indexOf(":"),o=m.substr(0,p),n=m.substr(p+1)),""!=d){var g="";"fileupload"==this.requesttype?g=" - File: "+this.file_id:"email"==this.requesttype&&(g=" - Email Notification"),this.chunk_id>0&&(g+=", Chunk: "+this.chunk_id),d=wfu_format_debug_data(d,g)}if(""!=o){var w=o.split(";");if(1==parseInt(w[2])){var y=w[3].split(",");i=wfu_plugin_decode_string(y[0]),_=y[4]}}}if(""==n||""==o){var h=this.fail_colors.split(","),b=wfu_Initialize_Params();b.general.shortcode_id=t,b.general.unique_id=this.unique_id,b.general.state=7,b.general.files_count="fileupload"==this.requesttype?1:0,b.general.upload_finish_time=this.finish_time,b.general.fail_message=GlobalData.consts.message_unknown,b.general.fail_admin_message=wfu_join_strings("<br />",this.error_adminmessage_unknown,this.requesttype+":"+m),b.general.files_count>0?(b[0]={},b[0].color=h[0],b[0].bgcolor=h[1],b[0].borcolor=h[2],b[0].message_type=f,i=f,b[0].header=this.error_message_header,b[0].message=GlobalData.consts.message_timelimit,b[0].admin_messages="true"==this.is_admin?GlobalData.consts.message_admin_timelimit:""):b.general.admin_messages.other="true"==this.is_admin?GlobalData.consts.message_admin_timelimit:"",b.general.upload_finish_time>0&&a.getTime()<b.general.upload_finish_time&&(b.general.files_count>0?(b[0].message=b.general.fail_message,b[0].admin_messages="true"==this.is_admin?b.general.fail_admin_message:""):b.general.admin_messages.other="true"==this.is_admin?b.general.fail_admin_message:"")}if("error"==i.substr(0,5)){if(this.chunk_id>0&&0==s)return void("true"==this.debugmode&&console.log("rejected xhr "+this.xhrid+" returned "+i+" message"));if(this.chunk_id>0&&"error"==i&&(GlobalData[t].chunkedfile[s-1].retries[this.chunk_id-1]++,-1==GlobalData.consts.wfu_repeated_chunk_fails||GlobalData[t].chunkedfile[s-1].retries[this.chunk_id-1]<=GlobalData.consts.wfu_repeated_chunk_fails))return wfu_chunk_reset(this),void("true"==this.debugmode&&console.log("repeating chunk "+this.chunk_id+" for "+GlobalData[t].chunkedfile[s-1].retries[this.chunk_id-1]+" times"));for(var v=0;v<GlobalData[t].xhrs.length;v++)GlobalData[t].xhrs[v].file_id==s&&(GlobalData[t].xhrs[v].aborted=!0,GlobalData[t].xhrs[v].abort(),GlobalData[t].xhrs[v].sizeloaded=GlobalData[t].xhrs[v].size,"true"==this.debugmode&&console.log("upload aborted for file "+this.file_id+" and chunk "+this.chunk_id))}else if(this.chunk_id>0){if(0==s)return void("true"==this.debugmode&&console.log("rejected xhr "+this.xhrid+" returned success message"));GlobalData[t].chunkedfile[s-1].uploadflag[this.chunk_id-1]=2}"error"==i.substr(0,5)&&(i=i.substr(0,5));var G=!1;if(this.chunk_id>0){G=!0;for(var v=0;v<GlobalData[t].chunkedfile[s-1].uploadflag.length;v++)if(GlobalData[t].chunkedfile[s-1].uploadflag[v]<2){G=!1;break}G=G||"error"==i}else G=this.totalsize>0||"error"==i;if(G&&(GlobalData[t].uploadflag[s-1]=2,bar=document.getElementById("filelist_"+t+"_fileprogress_animation"+s),bar&&(document.getElementById("filelist_"+t+"_file"+s).className="file_filelist_file_div_with_remove",document.getElementById("filelist_"+t+"_fileremove_imgx"+s).style.display="none",document.getElementById("filelist_"+t+"_fileremove_imgok"+s).style.display="success"==i||"warning"==i?"":"none",document.getElementById("filelist_"+t+"_fileremove_imgunknown"+s).style.display="unknown"==i?"":"none",document.getElementById("filelist_"+t+"_fileremove_imgfail"+s).style.display="error"==i?"":"none",document.getElementById("filelist_"+t+"_fileremove"+s).style.display="",document.getElementById("filelist_"+t+"_fileprogress_td"+s).style.display="none"),""!=_)){_=wfu_plugin_decode_string(_.replace(/^\s+|\s+$/g,""));var I=null;try{I=JSON.parse(_)}catch(k){}if(null!=I)for(var B=I.user,E=document.querySelectorAll(".wfu_browser_id"),v=0;v<E.length;v++){var x=E[v].value;"0"==B&&(I.user=document.getElementById("wfu_browser_guesttitle_"+x).value,I.user_sort=I.user),wfu_browser_add_file(x,I)}}return l=""==n||""==o?wfu_ProcessUploadComplete(t,this.file_id,b,this.unique_id,this.params_index,this.session_token,"",[this.debugmode,d,this.is_admin],this.requesttype,""):wfu_ProcessUploadComplete(t,this.file_id,n,this.unique_id,this.params_index,this.session_token,o,[this.debugmode,d,this.is_admin],this.requesttype,r),l&&(wfu_unlock_upload(e.target.shortcode_id),wfu_unlock_progressbar(t),wfu_hide_simple_progressbar(t),wfu_clear(e.target.shortcode_id)),e.target.return_status?i:void 0}function wfu_ProcessUploadComplete(sid,file_id,upload_params,unique_id,params_index,session_token,safe_output,debug_data,request_type,js_script_enc){if(sid&&!(0>sid)&&null!=upload_params&&""!=upload_params&&""!=unique_id&&("no-ajax"==unique_id||GlobalData[sid])){var do_redirect=!1;if("string"==typeof upload_params){upload_params=wfu_plugin_decode_string(upload_params.replace(/^\s+|\s+$/g,""));var Params=null;try{Params=JSON.parse(upload_params)}catch(e){}if(null==Params){var safe_parts=safe_output.split(";");Params=wfu_Initialize_Params(),Params.general.shortcode_id=sid,Params.general.unique_id=unique_id,Params.general.state=safe_parts[0],4==Params.general.state&&Params.general.state++;var default_colors=safe_parts[1].split(","),filedata="",error_jsonparse_filemessage=GlobalData.consts.jsonparse_filemessage,error_jsonparse_message=GlobalData.consts.jsonparse_message,error_jsonparse_adminmessage=GlobalData.consts.jsonparse_adminmessage;Params.general.files_count=parseInt(safe_parts[2]);for(var i=0;i<Params.general.files_count;i++)Params[i]={},Params[i].color=default_colors[0],Params[i].bgcolor=default_colors[1],Params[i].borcolor=default_colors[2],filedata=safe_parts[i+3].split(","),Params[i].message_type=wfu_plugin_decode_string(filedata[0]),Params[i].header=wfu_plugin_decode_string(filedata[1]),"success"==Params[i].message_type&&(Params[i].header+=error_jsonparse_filemessage,Params[i].message_type="warning"),Params[i].message=wfu_join_strings("<br />",error_jsonparse_message,wfu_plugin_decode_string(filedata[2])),Params[i].admin_messages=wfu_join_strings("<br />",error_jsonparse_adminmessage,wfu_plugin_decode_string(filedata[3]))}}else{if("object"!=typeof upload_params)return;var Params=upload_params}for(i=0;Params[i];)Params[i].message_type&&"error"==Params[i].message_type.substr(0,5)&&(Params[i].message_type=Params[i].message_type.substr(0,5)),i++;var message_table=document.getElementById("wfu_messageblock_"+sid),UploadStates_Ok=!0;if(!UploadStates[sid]&&message_table){var upload_states=document.getElementById("wfu_messageblock_header_"+sid+"_states").value;upload_states=wfu_plugin_decode_string(upload_states.replace(/^\s+|\s+$/g,"")),UploadStates[sid]=null;try{UploadStates[sid]=JSON.parse(upload_states)}catch(e){}null==UploadStates[sid]&&(UploadStates_Ok=!1)}GlobalData[sid]||(GlobalData[sid]=Object());var G=GlobalData[sid];if("no-ajax"==unique_id)G.last=!1,G.unique_id="",G.files_count=Params.general.files_count,0==Params.general.state&&(Params.general.files_count=0),G.files_processed=Params.general.files_count,G.upload_state=UploadStates_Ok?Params.general.state:10,G.message=Params.general.message,G.update_wpfilebase=Params.general.update_wpfilebase,G.redirect_link=Params.general.redirect_link,G.notify_only_filename_list="",G.notify_target_path_list="",G.notify_attachment_list="",G.admin_messages={},G.admin_messages.wpfilebase=Params.general.admin_messages.wpfilebase,G.admin_messages.notify=Params.general.admin_messages.notify,G.admin_messages.redirect=Params.general.admin_messages.redirect,G.admin_messages.debug=debug_data[1],G.admin_messages.other=Params.general.admin_messages.other,G.errors={},G.errors.wpfilebase=Params.general.errors.wpfilebase,G.errors.notify=Params.general.errors.notify,G.errors.redirect=Params.general.errors.redirect,G.current_size=0,G.total_size=0;else{if(""==G.unique_id||G.unique_id!=unique_id||G.unique_id!=Params.general.unique_id)return;if(G.last)return;0==Params.general.files_count&&Params[0]?("error"==Params[0].message_type&&(Params.general.files_count=1),G[file_id-1]||(G[file_id-1]={}),("success"==G[file_id-1].message_type&&"success"!=Params[0].message_type||"warning"==G[file_id-1].message_type&&"error"==Params[0].message_type||!G[file_id-1].message_type)&&(G[file_id-1].message_type=Params[0].message_type,G[file_id-1].header=Params[0].header,G[file_id-1].color=Params[0].color,G[file_id-1].bgcolor=Params[0].bgcolor,G[file_id-1].borcolor=Params[0].borcolor,""!=Params[0].message&&(G[file_id-1].message=Params[0].message),""!=Params[0].admin_messages&&(G[file_id-1].admin_messages=Params[0].admin_messages))):1==Params.general.files_count&&G[file_id-1]&&("success"==Params[0].message_type&&"success"!=G[file_id-1].message_type||"warning"==Params[0].message_type&&"error"==G[file_id-1].message_type)&&(Params[0].message_type=G[file_id-1].message_type,Params[0].header=G[file_id-1].header,Params[0].color=G[file_id-1].color,Params[0].bgcolor=G[file_id-1].bgcolor,Params[0].borcolor=G[file_id-1].borcolor,""!=G[file_id-1].message&&(Params[0].message=G[file_id-1].message),""!=G[file_id-1].admin_messages&&(Params[0].admin_messages=G[file_id-1].admin_messages));for(var file_status="",i=0;i<Params.general.files_count;i++)file_status="error"==Params[i].message_type&&0==G.files_processed?"error1":"error"==Params[i].message_type&&G.files_processed>0?"error2":Params[i].message_type,G.upload_state=GlobalData.filestatematch[file_status][G.upload_state];UploadStates_Ok||(G.upload_state=10),G.files_processed+=Params.general.files_count,G.message=wfu_join_strings("<br />",G.message,Params.general.message),""==G.update_wpfilebase&&(G.update_wpfilebase=Params.general.update_wpfilebase),(!request_type||request_type&&"email"!=request_type)&&(G.redirect_link=Params.general.redirect_link),G.notify_only_filename_list=wfu_join_strings(", ",G.notify_only_filename_list,Params.general.notify_only_filename_list),G.notify_target_path_list=wfu_join_strings(", ",G.notify_target_path_list,Params.general.notify_target_path_list),G.notify_attachment_list=wfu_join_strings(",",G.notify_attachment_list,Params.general.notify_attachment_list),G.admin_messages.debug=wfu_join_strings("<br />",G.admin_messages.debug,debug_data[1]),G.admin_messages.other=wfu_join_strings("<br />",G.admin_messages.other,Params.general.admin_messages.other),""==G.admin_messages.wpfilebase&&(G.admin_messages.wpfilebase=Params.general.admin_messages.wpfilebase),""==G.admin_messages.notify&&(G.admin_messages.notify=Params.general.admin_messages.notify),""==G.admin_messages.redirect&&(G.admin_messages.redirect=Params.general.admin_messages.redirect),""==G.errors.wpfilebase&&(G.errors.wpfilebase=Params.general.errors.wpfilebase),""==G.errors.notify&&(G.errors.notify=Params.general.errors.notify),""==G.errors.redirect&&(G.errors.redirect=Params.general.errors.redirect)}G.files_processed==G.files_count&&(G.last=!0,""!=G.update_wpfilebase&&(G.admin_messages.wpfilebase="",wfu_notify_WPFilebase(params_index,session_token)),""!=G.notify_only_filename_list&&(G.admin_messages.notify="",wfu_send_email_notification(sid,unique_id,params_index,session_token,G.notify_only_filename_list,G.notify_target_path_list,G.notify_attachment_list,debug_data[0],debug_data[2]),G.last=!1,G.notify_only_filename_list=""),G.last&&("no-ajax"!=unique_id&&wfu_notify_server_upload_ended(sid,unique_id,params_index,session_token),GlobalData.UploadInProgressString=GlobalData.UploadInProgressString.replace(new RegExp("\\["+unique_id+"\\]","g"),"")),""!=G.errors.redirect&&(G.redirect_link=""),""!=G.redirect_link&&G.last&&""==GlobalData.UploadInProgressString.trim()&&(G.upload_state=11,do_redirect=!0));var nonadmin_message=G.message,admin_message=wfu_join_strings("<br />",G.admin_messages.other,G.admin_messages.wpfilebase,G.admin_messages.notify,G.admin_messages.redirect,G.admin_messages.debug);if(!UploadStates_Ok){var error_jsonparse_headermessage=GlobalData.consts.jsonparse_headermessage,error_jsonparse_headeradminmessage=GlobalData.consts.jsonparse_headeradminmessage;nonadmin_message=wfu_join_strings("<br />",error_jsonparse_headermessage,nonadmin_message),admin_message=wfu_join_strings("<br />",error_jsonparse_headeradminmessage,admin_message)}if(G.last){0==G.files_count?G.upload_state=8:G.upload_state<4&&(G.upload_state+=4);var admin_messages_exist=""!=G.admin_messages.wpfilebase||""!=G.admin_messages.notify||""!=G.admin_messages.redirect||""!=G.admin_messages.other;4==G.upload_state&&""!=admin_message?G.upload_state++:5==G.upload_state&&""==!admin_message&&""==nonadmin_message&&G.upload_state--}if(message_table){var subheader_state=document.getElementById("wfu_messageblock_header_"+sid+"_state"),single_file_shown=1==G.files_count&&""==nonadmin_message&&""==admin_message&&G.last&&!do_redirect;if(single_file_shown)document.getElementById("wfu_messageblock_header_"+sid).style.display="none";else{document.getElementById("wfu_messageblock_header_"+sid).style.display="";var header_container=document.getElementById("wfu_messageblock_header_"+sid+"_container");if(UploadStates_Ok){var suffix="";1!=G.files_count||5!=G.upload_state&&7!=G.upload_state||(suffix="_singlefile"),header_container.innerHTML=UploadStates[sid]["State"+G.upload_state+suffix]
}else{header_container.innerHTML="";var safe_container=document.getElementById("wfu_messageblock_header_"+sid+"_safecontainer");header_container.innerHTML=safe_container.innerHTML.replace(/_safe/g,"")}var subheader_show=!1;""!=nonadmin_message?(document.getElementById("wfu_messageblock_subheader_"+sid+"_message").style.display="",document.getElementById("wfu_messageblock_subheader_"+sid+"_messagelabel").innerHTML=nonadmin_message,subheader_show=!0):document.getElementById("wfu_messageblock_subheader_"+sid+"_message").style.display="none",""!=admin_message?(document.getElementById("wfu_messageblock_subheader_"+sid+"_adminmessage").style.display="",document.getElementById("wfu_messageblock_subheader_"+sid+"_adminmessagelabel").innerHTML=admin_message,subheader_show=!0):document.getElementById("wfu_messageblock_subheader_"+sid+"_adminmessage").style.display="none",document.getElementById("wfu_messageblock_subheader_"+sid).style.display=subheader_show?subheader_state.value:"none",subheader_show||G.files_processed>0?(header_container.colSpan=2,document.getElementById("wfu_messageblock_arrow_"+sid).style.display=""):(document.getElementById("wfu_messageblock_arrow_"+sid).style.display="none",header_container.colSpan=3)}for(var next_block=document.getElementById("wfu_messageblock_subheader_"+sid),next_block_id=0,file_block=null,file_template_container=document.getElementById("wfu_messageblock_"+sid+"_filetemplate"),file_contents="",door=document.getElementById("wfu_messageblock_"+sid+"_door"),ii=0,headerspan=1,subheaderspan=2,file_template=wfu_plugin_decode_string(file_template_container.value.replace(/^\s+|\s+$/g,"")),i=0;i<Params.general.files_count;i++){for(ii=i+file_id,file_contents=file_template.replace(/\[file_id\]/g,ii),file_contents=file_contents.replace(/\[filenumber_display\]/g,""),file_contents=file_contents.replace(/\[fileheader_color\]/g,Params[i].color),file_contents=file_contents.replace(/\[fileheader_bgcolor\]/g,Params[i].bgcolor),file_contents=file_contents.replace(/\[fileheader_borcolor\]/g,Params[i].borcolor),file_contents=file_contents.replace(/\[fileheader_message\]/g,Params[i].header),file_contents=file_contents.replace(/\[filesubheadermessage_display\]/g,'style="display:none;"'),file_contents=file_contents.replace(/\[filesubheader_message\]/g,Params[i].message),file_contents=file_contents.replace(/\[filesubheaderadminmessage_display\]/g,'style="display:none;"'),file_contents=file_contents.replace(/\[filesubheader_adminmessage\]/g,Params[i].admin_messages),file_contents="<table><tbody>"+file_contents+"</tbody></table>",door.innerHTML=file_contents,headerspan=1,subheaderspan=2,subheader_show=!1,file_block=document.getElementById("wfu_messageblock_"+sid+"_"+ii),1==G.files_count?(document.getElementById("wfu_messageblock_"+sid+"_filenumber_"+ii).style.display="none",document.getElementById("wfu_messageblock_subheader_"+sid+"_fileempty_"+ii).style.display="none",file_block.style.display=single_file_shown?"":subheader_state.value,headerspan++,subheaderspan++):file_block.style.display=subheader_state.value,""!=Params[i].message&&(document.getElementById("wfu_messageblock_subheader_"+sid+"_message_"+ii).style.display="",subheader_show=!0),""!=Params[i].admin_messages&&(document.getElementById("wfu_messageblock_subheader_"+sid+"_adminmessage_"+ii).style.display="",subheader_show=!0),subheader_show||(document.getElementById("wfu_messageblock_arrow_"+sid+"_"+ii).style.display="none",headerspan++),document.getElementById("wfu_messageblock_header_"+sid+"_container_"+ii).colSpan=headerspan,document.getElementById("wfu_messageblock_subheader_"+sid+"_container_"+ii).colSpan=subheaderspan;ii>next_block_id&&(next_block=next_block.nextSibling,null!=next_block);)1===next_block.nodeType&&(next_block_id=next_block.id.substr(next_block.id.lastIndexOf("_")+1));message_table.tBodies[0].insertBefore(file_block,next_block),next_block=file_block.nextSibling,file_block=document.getElementById("wfu_messageblock_subheader_"+sid+"_"+ii),message_table.tBodies[0].insertBefore(file_block,next_block),next_block=file_block,next_block_id=ii}single_file_shown&&(document.getElementById("wfu_messageblock_"+sid+"_1").style.display=""),message_table.style.display="",document.getElementById("wordpress_file_upload_message_"+sid).style.display=""}return js_script_enc&&eval(wfu_plugin_decode_string(js_script_enc)),do_redirect&&wfu_Redirect(G.redirect_link),G.last}}function wfu_uploadFailed(e,a){a&&(console.log("failure report following"),console.log(e));var t=e.target,s={target:{responseText:"",shortcode_id:t.shortcode_id}};wfu_uploadComplete.call(t,s)}function wfu_uploadCanceled(){}function wfu_notify_server_upload_ended(e,a,t,s){var l=wfu_GetHttpRequestObject();if(null!=l){var r=GlobalData.consts.ajax_url;params=new Array(5),params[0]=new Array(2),params[0][0]="action",params[0][1]="wfu_ajax_action",params[1]=new Array(2),params[1][0]="uniqueuploadid_"+e,params[1][1]=a,params[2]=new Array(2),params[2][0]="params_index",params[2][1]=t,params[3]=new Array(2),params[3][0]="session_token",params[3][1]=s,params[4]=new Array(2),params[4][0]="upload_finished",params[4][1]=1;for(var n="",o=0;o<params.length;o++)n+=(o>0?"&":"")+params[o][0]+"="+encodeURI(params[o][1]);l.open("POST",r,!0),l.setRequestHeader("Content-type","application/x-www-form-urlencoded"),l.onreadystatechange=function(){4==l.readyState&&200==l.status},l.send(n)}}function wfu_Initialize_Params(){var e={};return e.version="full",e.general={},e.general.shortcode_id=0,e.general.unique_id="",e.general.state=0,e.general.files_count=0,e.general.update_wpfilebase="",e.general.redirect_link="",e.general.upload_finish_time=0,e.general.message="",e.general.message_type="",e.general.admin_messages={},e.general.admin_messages.wpfilebase="",e.general.admin_messages.notify="",e.general.admin_messages.redirect="",e.general.admin_messages.other="",e.general.errors={},e.general.errors.wpfilebase="",e.general.errors.notify="",e.general.errors.redirect="",e.general.color="",e.general.bgcolor="",e.general.borcolor="",e.general.notify_only_filename_list="",e.general.notify_target_path_list="",e.general.notify_attachment_list="",e.general.fail_message="",e.general.fail_admin_message="",e}function wfu_redirect_to_classic(e,a,t,s){var l=document.getElementById("upfile_"+e),r=!1;if("undefined"!=typeof l.filearray){farrprops=l.filearrayprops;for(var n=0;n<farrprops.length;n++)if("dragdrop"==farrprops[n].from){r=!0;break}r&&(wfu_filelist_clear(e),alert(GlobalData.consts.redirection_nodragdrop))}if(0!=wfu_filesselected(e)&&wfu_selectsubdir_check(e)&&wfu_check_required_userdata(e,!0)){var o=document.getElementById("captchachallenge_"+e).value;if(""==o)wfu_redirect_to_classic_cont(e,a,t,s,[""]);else{var i="",_=document.getElementById("captcha_"+e+"_input"),d=document.getElementById("captcha_"+e+"_empty_overlay"),u=document.getElementById("captcha_"+e+"_overlay_error_label");i=document.getElementById("captchainput_"+e).value,""==i||_&&"file_captcha_input_empty"==_.className?(_&&(_.value=GlobalData.consts.captchamessage_noinput,_.className="file_captcha_input_empty"),d&&(d.parentNode.className="file_captcha_inner_v2 file_captcha_inner_v2_empty",u.innerHTML=GlobalData.consts.captchamessage_empty,u.title=GlobalData.consts.captchamessage_empty)):wfu_redirect_to_classic_cont(e,a,t,s,[o,i])}}}function wfu_redirect_to_classic_cont(e,a,t,s,l){var r=function(l){if(l.indexOf("wfu_response_success:")>-1){_&&(_.value=GlobalData.consts.captchamessage_Ok,_.className="file_captcha_input_Ok"),wfu_lockrun_progressbar(e,"shuffle");var r=wfu_Initialize_Params();if(r.general.shortcode_id=e,r.general.unique_id="",r.general.files_count=wfu_filesselected(e),wfu_ProcessUploadComplete(e,0,r,"no-ajax","",a,"",["false","","false"]),1==t){var n="",o=document.getElementById("upfile_"+e).name;"[]"==o.substr(o.length-2,2)&&(n="[]"),document.getElementById("upfile_"+e).name="uploadedfile_"+e+"_redirected"+n}document.getElementById("adminerrorcodes_"+e).value=s>0?s:"",document.getElementById("upfile_"+e).disabled=!1,document.getElementById("uniqueuploadid_"+e).value=wfu_randomString(10),document.getElementById("uploadform_"+e).submit()}else if(l.indexOf("wfu_response_captchaerror:")>-1){var i=l.indexOf("wfu_response_captchaerror:");wfu_process_captcha_error(e,l.substr(i+26)),wfu_unlock_upload(e),wfu_unlock_progressbar(e)}},n="",o=l[0],i=l[1],_=document.getElementById("captcha_"+e+"_input"),d=document.getElementById("captcha_"+e+"_empty_overlay"),u=document.getElementById("captcha_"+e+"_overlay_error_label");n="&captcha_challenge="+o+"&captcha_input="+i;var c=new Date,m=GlobalData.consts.ajax_url+"?action=wfu_ajax_action&sid="+e+"&start_time="+c.getTime()+"&session_token="+a+n;wfu_lock_upload(e),wfu_lock_progressbar(e),_&&(_.value=GlobalData.consts.captchamessage_checking,_.className="file_captcha_input_checking"),d&&(d.parentNode.className="file_captcha_inner_v2 file_captcha_inner_v2_locked");var f=wfu_GetHttpRequestObject();if(null==f){var p=document.createElement("iframe");return p?(p.style.display="none",p.src=m,document.body.appendChild(p),void(p.onload=function(){r(p.contentDocument.body.innerHTML)})):(alert(GlobalData.consts.captchamessage_notsupported),_&&(_.value=GlobalData.consts.captchamessage_notsupported,_.className="file_captcha_input_empty"),void(d&&(d.parentNode.className="file_captcha_inner_v2 file_captcha_inner_v2_empty",u.innerHTML=GlobalData.consts.captchamessage_notsupported,u.title=GlobalData.consts.captchamessage_notsupported)))}f.open("GET",m,!0),f.onreadystatechange=function(){4==f.readyState&&(200==f.status?r(f.responseText):(alert(GlobalData.consts.remoteserver_noresult),_&&(_.value="",_.className="file_captcha_input_empty")))},f.send(null)}function wfu_process_message(e,a){if(e.origin===a&&e.data.command&&e.data.data)if("wfu_notify_captcha_ok"==e.data.command){if(!e.data.data.response||!e.data.data.sid)return;wfu_captcha_ok(e.data.data.sid,e.data.data.response)}else if("wfu_notify_captcha_expired"==e.data.command){if(!e.data.data.sid)return;wfu_captcha_expired(e.data.data.sid)}else if("wfu_resize_captcha_frame"==e.data.command){if(!e.data.data.sid||!e.data.data.width||!e.data.data.height)return;var t=e.data.data.sid,s=document.getElementById("captcha_"+t+"_frame"),l=document.getElementById("captcha_"+t+"_inner");s.style.width=e.data.data.width+"px",s.style.height=e.data.data.height+"px",l.style.width=e.data.data.width+"px"}}function wfu_send_captcha_reset_command(e){if(window["wfu_send_captcha_reset_command_invoker_"+e]){window["wfu_send_captcha_reset_command_invoker_"+e]();var a=document.getElementById("captchainput_"+e);a.value="",wfu_update_uploadbutton_status(e)}}function wfu_send_captcha_reset_command_internal(e){grecaptcha&&"undefined"!=typeof window["captcha_instance_"+e]&&grecaptcha.reset(window["captcha_instance_"+e])}function wfu_send_captcha_reset_command_external(e,a){var t=document.getElementById("captcha_"+e+"_frame");if(t){var s=t.contentWindow||t;s.postMessage({command:"wfuca_reset_captcha",data:{}},a)}}function wfu_captcha_ok(e,a){var t=document.getElementById("captchainput_"+e);t.value="",""==a||a.toLowerCase().indexOf("error")>-1||(t.value=a,wfu_update_uploadbutton_status(e))}function wfu_captcha_expired(e){var a=document.getElementById("captchainput_"+e);a.value="",wfu_update_uploadbutton_status(e)}function wfu_refresh_captcha(e,a){var t=function(a){var t="wfu_captcha_success:",l=a.indexOf(t),r="";l>-1&&(r=a.substr(l+t.length)),""==r?(s.value=GlobalData.consts.captchamessage_refreshingerror,s.disabled=!1,s.className="file_captcha_input_empty"):(document.getElementById("captchachallenge_"+e).value=r,document.getElementById("captchainput_"+e).value="",s.value="",s.disabled=!1,s.className="file_captcha_input",document.getElementById("captcha_"+e+"_image").src="//www.google.com/recaptcha/api/image?c="+r)};if(document.getElementById("captcha_"+e)){document.getElementById("captcha_"+e+"_loading").className="file_captcha_loading_outer";var s=document.getElementById("captcha_"+e+"_input");s.value=GlobalData.consts.captchamessage_refreshing,s.className="file_captcha_input",s.disabled=!0,document.getElementById("captcha_"+e+"_image").src=GlobalData.consts.captchaimage_empty;var l=wfu_GetHttpRequestObject();if(null==l){var r=document.getElementById("captcha_"+e+"_hiddenframe"),n=GlobalData.consts.ajax_url+"?action=wfu_ajax_action_refresh_captcha&sid="+e+"&session_token="+a;return r.src=n,void(r.onload=function(){t(r.contentDocument.body.innerHTML),document.getElementById("captcha_"+e+"_loading").style.display="none"})}var n=GlobalData.consts.ajax_url;params=new Array(3),params[0]=new Array(2),params[0][0]="action",params[0][1]="wfu_ajax_action_refresh_captcha",params[1]=new Array(2),params[1][0]="session_token",params[1][1]=a,params[2]=new Array(2),params[2][0]="sid",params[2][1]=e;for(var o="",r=0;r<params.length;r++)o+=(r>0?"&":"")+params[r][0]+"="+encodeURI(params[r][1]);l.open("POST",n,!0),l.setRequestHeader("Content-type","application/x-www-form-urlencoded"),l.onreadystatechange=function(){4==l.readyState&&(200==l.status?t(l.responseText):(alert(GlobalData.consts.remoteserver_noresult),s.value="",s.disabled=!1,s.className="file_captcha_input_empty"),document.getElementById("captcha_"+e+"_loading").className="file_captcha_overlay_hidden")},l.send(o)}}function wfu_process_captcha_error(e,a){var t=document.getElementById("captcha_"+e+"_input"),s=document.getElementById("captcha_"+e+"_empty_overlay"),l=document.getElementById("captcha_"+e+"_overlay_error_label"),r=a.indexOf(":"),n=a.substr(0,r);if(a=a.substr(r+1,a.length-r-1),""!=a){var o="wfu_captcha_success:";r=a.indexOf(o);var i="";if(r>-1&&(i=a.substr(r+o.length)),""!=i){document.getElementById("captchachallenge_"+e).value=i;var _=document.getElementById("captcha_"+e+"_image");_&&(_.src="//www.google.com/recaptcha/api/image?c="+i)}}if(t&&(t.value="nochallenge"==n||"noinput"==n||"wrongcaptcha"==n?GlobalData.consts["captchamessage_"+n]:GlobalData.consts.captchamessage_unknownerror,t.className="file_captcha_input_empty"),s)if("nochallenge"==n||"noinput"==n||"wrongcaptcha"==n)l.innerHTML=GlobalData.consts["captchamessage_"+n],l.title=GlobalData.consts["captchamessage_"+n];else if("("==n.substr(0,1)&&")"==n.substr(n.length-1,1)){n=n.substr(1,n.length-2);for(var d=n.split("|"),u="",c=0;c<d.length;c++)GlobalData.consts["captchamessage_"+d[c].trim()]&&(""!=u&&(u+=" and "),u+=GlobalData.consts["captchamessage_"+d[c].trim()]);""==u&&(u=GlobalData.consts.captchamessage_unknownerror),l.innerHTML=u,l.title=u}}function wfu_filesselected(e){var a=document.getElementById("fileName_"+e),t=wfu_get_filelist(e);return 0==t.length&&a&&(a.value=GlobalData.consts.nofilemessage,a.className="file_input_textbox_nofile"),t.length}function wfu_check_required_userdata(e,a){for(var t=wfu_get_userdata_count(e),s=!1,l=0;t>l;l++){var r=document.getElementById("hiddeninput_"+e+"_userdata_"+l),n=document.getElementById("userdata_"+e+"_fieldwrapper_"+l),o=document.getElementById("userdata_"+e+"_field_"+l),i=document.getElementById("userdata_"+e+"_"+l),_=document.getElementById("userdata_"+e+"_hint_"+l);r.value=window["userdata_"+e+"_codes_"+l].value(o);for(var d={hintposition:"none"},u=document.getElementById("userdata_"+e+"_props_"+l).value.split("|"),c=0;c<u.length;c++)"p:"==u[c].substr(0,2)&&(d.hintposition=u[c].substr(2));var m="";if("file_userdata_fieldwrapper_required"==n.className.substr(0,35)&&(m=window["userdata_"+e+"_codes_"+l].empty(r)),""===m&&window["userdata_"+e+"_codes_"+l].validate&&(m=window["userdata_"+e+"_codes_"+l].validate(r)),""!==m){if(a)if("none"==d.hintposition)_.className="file_userdata_hint_none";else{n.className="file_userdata_fieldwrapper_required_empty";var f=i.getBoundingClientRect(),p=n.getBoundingClientRect();"inline"==d.hintposition?(_.className="file_userdata_hint_inline",_.style.left=parseInt(p.left-f.left)+"px",_.style.top=parseInt(p.top-f.top)+"px",_.style.right=parseInt(f.right-p.right)+"px",_.style.bottom=parseInt(f.bottom-p.bottom)+"px"):"top"==d.hintposition?(_.className="file_userdata_hint_top",_.style.left=parseInt(p.left-f.left)+"px",_.style.bottom=parseInt(f.bottom-p.top)+"px"):"right"==d.hintposition?(_.className="file_userdata_hint_right",_.style.left=parseInt(p.right-f.left)+"px",_.style.top=parseInt(p.top-f.top)+"px"):"bottom"==d.hintposition?(_.className="file_userdata_hint_bottom",_.style.left=parseInt(p.left-f.left)+"px",_.style.top=parseInt(p.bottom-f.top)+"px"):"left"==d.hintposition&&(_.className="file_userdata_hint_left",_.style.right=parseInt(f.right-p.left)+"px",_.style.top=parseInt(p.top-f.top)+"px"),_.innerHTML=m,_.style.display="block"}s=!0}}return!s}function wfu_HTML5UploadFile(e,a,t){if(!wfu_BrowserCaps.supportsAJAX)return void wfu_redirect_to_classic(e,t,1,1);if(!wfu_BrowserCaps.supportsHTML5)return void wfu_redirect_to_classic(e,t,1,2);a=wfu_plugin_decode_string(a.replace(/^\s+|\s+$/g,""));var s=null;try{s=JSON.parse(a)}catch(l){}if(null==s)return void wfu_redirect_to_classic(e,t,1,3);var r=wfu_GetHttpRequestObject();if(null!=r){var n=wfu_filesselected(e);if(0!=n){var o=document.getElementById("upload_"+e),i=!o;if(!wfu_selectsubdir_check(e))return void(i&&wfu_clear_files(e));var _=n;_+=_;var d=wfu_get_filelist(e);_=0;for(var u=0;u<d.length;u++)if(_++,wfu_BrowserCaps.supportsFileChunking&&"true"==s.chunk&&d[u].size>GlobalData.consts.wfu_chunk_size){var c=Math.floor(d[u].size/GlobalData.consts.wfu_chunk_size),m=d[u].size-c*GlobalData.consts.wfu_chunk_size;m>0&&c++,_+=c}else _++;if(!wfu_check_required_userdata(e,!0))return void(i&&wfu_clear_files(e));var f=document.getElementById("captchachallenge_"+e).value;if(""==f)wfu_lock_upload(e),wfu_lock_progressbar(e),wfu_HTML5UploadFile_cont(e,s,t,[""]);else{var p="",g=document.getElementById("captcha_"+e+"_input"),w=document.getElementById("captcha_"+e+"_empty_overlay"),y=document.getElementById("captcha_"+e+"_overlay_error_label");if(p=document.getElementById("captchainput_"+e).value,""==p||g&&"file_captcha_input_empty"==g.className)g&&(g.value=GlobalData.consts.captchamessage_noinput,g.className="file_captcha_input_empty"),w&&(w.parentNode.className="file_captcha_inner_v2 file_captcha_inner_v2_empty",y.innerHTML=GlobalData.consts.captchamessage_empty,y.title=GlobalData.consts.captchamessage_empty);else{wfu_lock_upload(e),wfu_lock_progressbar(e),g&&(g.value=GlobalData.consts.captchamessage_checking,g.className="file_captcha_input_checking"),w&&(w.parentNode.className="file_captcha_inner_v2 file_captcha_inner_v2_locked");var h=GlobalData.consts.ajax_url;params=new Array(6),params[0]=new Array(2),params[0][0]="action",params[0][1]="wfu_ajax_action_check_captcha",params[1]=new Array(2),params[1][0]="captcha_challenge",params[1][1]=f,params[2]=new Array(2),params[2][0]="captcha_input",params[2][1]=p,params[3]=new Array(2),params[3][0]="session_token",params[3][1]=t,params[4]=new Array(2),params[4][0]="sid",params[4][1]=e,params[5]=new Array(2),params[5][0]="files_count",params[5][1]=_;for(var b="",u=0;u<params.length;u++)b+=(u>0?"&":"")+params[u][0]+"="+encodeURI(params[u][1]);r.open("POST",h,!0),r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.onreadystatechange=function(){if(4==r.readyState)if(200==r.status){var a=r.responseText,l="",n="wfu_captchacheck_success:",o="wfu_captchacheck_error:",i=a.indexOf(n),_=a.indexOf(o),d=-1;if(i>-1){l=a.substr(i+n.length);var u=a.substr(i+n.length,10),c="wfu_captcha_success:";d=l.indexOf(c);var m="";if(d>-1&&(m=l.substr(d+c.length)),""!=m){document.getElementById("captchachallenge_"+e).value=m;var f=document.getElementById("captcha_"+e+"_image");f&&(f.src="//www.google.com/recaptcha/api/image?c="+m)}g&&(g.value=GlobalData.consts.captchamessage_Ok,g.className="file_captcha_input_Ok"),wfu_HTML5UploadFile_cont(e,s,t,[p,u])}else _>-1&&(wfu_process_captcha_error(e,a.substr(_+o.length)),wfu_unlock_upload(e),w&&(w.parentNode.className="file_captcha_inner_v2 file_captcha_inner_v2_empty"),wfu_unlock_progressbar(e))}else alert(GlobalData.consts.remoteserver_noresult),g&&(g.value="",g.className="file_captcha_input_empty"),wfu_unlock_upload(e),wfu_unlock_progressbar(e)},r.send(b)}}}}}function wfu_HTML5UploadFile_cont(e,a,t,s){function l(r,o,i,d){h=!0;var u=wfu_GetHttpRequestObject(),c=wfu_GetHttpRequestObject();if(null!=u&&null!=c){var w=null,v=null;try{var w=new FormData,v=new FormData}catch(G){}if(null!=w&&null!=v){i||w.append("uploadedfile_"+e+f,o),w.append("uploadedfile_"+e+"_index",r),w.append("uploadedfile_"+e+"_name",wfu_plugin_encode_string(m[r].name)),w.append("uploadedfile_"+e+"_size",m[r].size),w.append("action","wfu_ajax_action"),w.append("uniqueuploadid_"+e,g),w.append("params_index",a.params_index),w.append("subdir_sel_index",_),i?w.append("only_check","1"):w.append("only_check","0"),GlobalData[e].uploadflag[r]=1,w.append("captcha_verify",s[0]);var I="0,0,0,0,";arguments.length>4&&(I=arguments[4]);var k=I.split(",");w.append("chunk_data",I),w.append("session_token",t),w.append("unique_id",p);for(var B=wfu_get_userdata_count(e),E=0;B>E;E++)w.append("hiddeninput_"+e+"_userdata_"+E,document.getElementById("hiddeninput_"+e+"_userdata_"+E).value);var x=GlobalData[e].xhrs.push(u)-1,D=new Date;if(u.xhrid=x,u.shortcode_id=e,u.requesttype="fileupload",u.file_id=r+1,u.chunk_id=0==k[2]?0:parseInt(k[3])+1,i?(u.size=0,u.totalsize=0,u.loading=!1):(u.size=o.size,u.totalsize=m[r].size,u.loading=!0,k[2]>0&&(GlobalData[e].chunkedfile[r].uploadflag[u.chunk_id-1]=1),k[2]>0&&(GlobalData[e].chunkedfile[r].xhrid[u.chunk_id-1]=x,GlobalData[e].chunkedfile[r].uploadflag[u.chunk_id-1]=1,GlobalData[e].chunkedfile[r].lasttime[u.chunk_id-1]=D.getTime())),u.deltasize=0,u.sizeloaded=0,u.aborted=!1,u.unique_id=g,u.params_index=a.params_index,u.session_token=t,u.debugmode=a.debugmode,u.is_admin=a.is_admin,u.start_time=D.getTime(),u.end_time=u.start_time,u.finish_time=u.start_time+1e3*parseInt(GlobalData.consts.max_time_limit),u.fail_colors=a.fail_colors,u.error_message_header=a.error_header.replace(/%username%/g,"no data"),u.error_message_header=u.error_message_header.replace(/%useremail%/g,"no data"),u.error_message_header=u.error_message_header.replace(/%filename%/g,m[r].name),u.error_message_header=u.error_message_header.replace(/%filepath%/g,m[r].name),u.error_message_failed=GlobalData.consts.message_failed,u.error_message_cancelled=GlobalData.consts.message_cancelled,u.error_adminmessage_unknown=GlobalData.consts.adminmessage_unknown.replace(/%username%/g,"no data"),u.error_adminmessage_unknown=u.error_adminmessage_unknown.replace(/%useremail%/g,"no data"),u.error_adminmessage_unknown=u.error_adminmessage_unknown.replace(/%filename%/g,m[r].name),u.error_adminmessage_unknown=u.error_adminmessage_unknown.replace(/%filepath%/g,m[r].name),d){v.append("action","wfu_ajax_action"),v.append("params_index",a.params_index),v.append("session_token",t),v.append("force_connection_close","1"),c.open("POST",GlobalData.consts.ajax_url,!1);try{c.send(v)}catch(P){}h="success"==c.responseText}if(h)i?(u.addEventListener("load",function(t){t={target:{responseText:t.target.responseText,shortcode_id:e,return_status:!0}};var s=wfu_uploadComplete.call(u,t);if(h="success"==s||"warning"==s)if(wfu_BrowserCaps.supportsFileChunking&&"true"==a.chunk&&o.size>GlobalData.consts.wfu_chunk_size){var i=Math.floor(o.size/GlobalData.consts.wfu_chunk_size),_=(o.size-i*GlobalData.consts.wfu_chunk_size,new Date);b[r]={},b[r].reps=Math.floor(o.size/GlobalData.consts.wfu_chunk_size),b[r].rem=o.size-b[r].reps*GlobalData.consts.wfu_chunk_size,b[r].chunk_count=0==b[r].rem?b[r].reps:b[r].reps+1,GlobalData[e].chunkedfile||(GlobalData[e].chunkedfile=[]),GlobalData[e].chunkedfile[r]={},GlobalData[e].chunkedfile[r].starttime=_.getTime(),GlobalData[e].chunkedfile[r].uploadflag=Array.apply(null,new Array(b[r].chunk_count)).map(Number.prototype.valueOf,0),GlobalData[e].chunkedfile[r].xhrid=Array.apply(null,new Array(b[r].chunk_count)).map(Number.prototype.valueOf,-1),GlobalData[e].chunkedfile[r].retries=Array.apply(null,new Array(b[r].chunk_count)).map(Number.prototype.valueOf,0),GlobalData[e].chunkedfile[r].lasttime=Array.apply(null,new Array(b[r].chunk_count)).map(Number.prototype.valueOf,0);var d=r;n(d)}else l(r,o,!1,!1)},!1),u.addEventListener("error",function(){},!1),u.open("POST",GlobalData.consts.ajax_url,!0),u.send(w)):(u.upload.xhr=u,u.upload.dummy=1,u.upload.addEventListener("loadstart",wfu_loadStart,!1),u.upload.addEventListener("progress",new Function("evt","wfu_uploadProgress(evt, "+e+", "+x+", "+a.debugmode+");"),!1),u.addEventListener("load",wfu_uploadComplete,!1),u.addEventListener("error",new Function("evt","wfu_uploadFailed(evt, "+a.debugmode+");"),!1),u.addEventListener("abort",wfu_uploadCanceled,!1),u.open("POST",GlobalData.consts.ajax_url,!0),u.send(w));else{var N={target:{responseText:"",shortcode_id:e}};wfu_uploadComplete.call(u,N)}return y++,h}}}function r(a){for(var t=!1,s=0,l=0;l<GlobalData[e].xhrs.length;l++)if(GlobalData[e].xhrs[l].file_id==a+1){if(GlobalData[e].xhrs[l].aborted){t=!0;break}GlobalData[e].xhrs[l].loading&&s++}return t?-1:s}function n(t){if(parseInt(GlobalData.consts.wfu_unfinishedchunk_inactivity_period)>-1)for(var s=Math.max(parseInt(GlobalData.consts.wfu_unfinishedchunk_inactivity_period),parseInt(GlobalData.consts.max_time_limit)),l=new Date,i=0;i<GlobalData[e].chunkedfile[t].uploadflag.length;i++)if(1==GlobalData[e].chunkedfile[t].uploadflag[i]&&l.getTime()>GlobalData[e].chunkedfile[t].lasttime[i]+1e3*s){"true"==a.debugmode&&console.log("reseting chunk "+i+" of file "+t);var _=GlobalData[e].chunkedfile[t].xhrid[i];wfu_chunk_reset(GlobalData[e].xhrs[_])}for(var d=-1,u=!0,i=0;i<GlobalData[e].chunkedfile[t].uploadflag.length;i++)if(GlobalData[e].chunkedfile[t].uploadflag[i]<2&&(u=!1,0==GlobalData[e].chunkedfile[t].uploadflag[i])){d=i;break}if(u){for(var c=new Date,m=c.getTime(),f=0,i=0;i<GlobalData[e].xhrs.length;i++)GlobalData[e].xhrs[i].file_id==t+1&&(m=Math.min(m,GlobalData[e].xhrs[i].start_time),f=Math.max(f,GlobalData[e].xhrs[i].end_time));var p=(f-m)/1e3;return void("true"==a.debugmode&&console.log("Upload time: "+p))}var g=r(t);"true"==a.debugmode&&console.log("running chunks: "+g),-1!=g&&(d>=0&&(-1==GlobalData.consts.wfu_concurrent_chunks||g<GlobalData.consts.wfu_concurrent_chunks)?(b[t].j=d,setTimeout(function(){o(t)},100)):setTimeout(function(){n(t)},1e3))}function o(e){var a=b[e].j*parseInt(GlobalData.consts.wfu_chunk_size),t=parseInt(GlobalData.consts.wfu_chunk_size);if(b[e].rem>0&&b[e].j==b[e].reps&&(t=b[e].rem),"function"==typeof m[e].slice)var s=m[e].slice(a,a+t);else if("function"==typeof m[e].webkitSlice)var s=m[e].webkitSlice(a,a+t);var r=""+e+","+m[e].size+","+b[e].chunk_count+","+b[e].j+","+wfu_plugin_encode_string(m[e].name);wfu_BrowserCaps.isSafari?(h=l(e,s,!1,!0,r),n(e)):(l(e,s,!1,!1,r),n(e))}function i(){for(var a=0,t=0;t<GlobalData[e].uploadflag.length;t++)1==GlobalData[e].uploadflag[t]&&a++;if(GlobalData.consts.wfu_concurrent_files<=0||a<GlobalData.consts.wfu_concurrent_files){for(var s=-1,t=0;t<GlobalData[e].uploadflag.length;t++)if(0==GlobalData[e].uploadflag[t]){s=t;break}s>=0&&(l(s,m[s],!0,!1),setTimeout(i,100))}else setTimeout(i,1e3)}var _=-1,d=document.getElementById("selectsubdir_"+e);if(d){var u=document.getElementById("selectsubdiredit_"+e),c="none"!=u.style.display;_=c?u.value:d.selectedIndex}var m=wfu_get_filelist(e),f="",p=wfu_randomString(10);s[1]&&10==s[1].length&&(p=s[1]);var g=p;GlobalData.UploadInProgressString+="["+g+"]",GlobalData[e]={},GlobalData[e].unique_id=g,GlobalData[e].last=!1,GlobalData[e].files_count=m.length,GlobalData[e].files_processed=0,GlobalData[e].upload_state=0,GlobalData[e].message="",GlobalData[e].update_wpfilebase="",GlobalData[e].redirect_link="",GlobalData[e].notify_only_filename_list="",GlobalData[e].notify_target_path_list="",GlobalData[e].notify_attachment_list="",GlobalData[e].admin_messages={},GlobalData[e].admin_messages.wpfilebase="",GlobalData[e].admin_messages.notify="",GlobalData[e].admin_messages.redirect="",GlobalData[e].admin_messages.debug="",GlobalData[e].admin_messages.other="",GlobalData[e].errors={},GlobalData[e].errors.wpfilebase="",GlobalData[e].errors.notify="",GlobalData[e].errors.redirect="",GlobalData[e].xhrs=Array(),GlobalData[e].uploadflag=Array.apply(null,new Array(m.length)).map(Number.prototype.valueOf,0),wfu_show_simple_progressbar(a.shortcode_id,"progressive"),wfu_lockrun_progressbar(e,"progressive"),wfu_filelist_showhide(e,!0),"true"==a.multiple&&(f="[]");var w=wfu_Initialize_Params();w.general.shortcode_id=e,w.general.unique_id=g,wfu_ProcessUploadComplete(e,0,w,g,a.params_index,t,"",["false","","false"]);var y=0,h=!0,b=[];setTimeout(i,100)}function wfu_chunk_reset(e){var a=e.shortcode_id,t=e.file_id;e.file_id=0;for(var s=0;s<GlobalData[a].xhrs.length;s++)GlobalData[a].xhrs[s].file_id==t&&(GlobalData[a].xhrs[s].totalsize-=e.deltasize);e.size=0,e.totalsize=0,e.deltasize=0,e.sizeloaded=0,GlobalData[a].chunkedfile[t-1].uploadflag[e.chunk_id-1]=0,GlobalData[a].chunkedfile[t-1].xhrid[e.chunk_id-1]=-1}function wfu_get_userdata_count(e){for(var a=0;document.getElementById("userdata_"+e+"_"+a);)a++;return a}function wfu_lock_upload(e){var a=document.getElementById("fileName_"+e);a&&(a.disabled=!0),document.getElementById("input_"+e).disabled=!0,document.getElementById("upfile_"+e).disabled=!0,wfu_selectsubdir_disable_onoff(e,!0);var t=document.getElementById("upload_"+e);t&&(t.disabled=!0);for(var s=wfu_get_userdata_count(e),l=0;s>l;l++)window["userdata_"+e+"_codes_"+l].lock(document.getElementById("userdata_"+e+"_field_"+l));var r=document.getElementById("captcha_"+e);if(r){var n=document.getElementById("captcha_"+e+"_input"),o=document.getElementById("captcha_"+e+"_empty_overlay");n&&(document.getElementById("captcha_"+e+"_loading").className="file_captcha_overlay_outer",n.disabled=!0),o&&(o.parentNode.className="file_captcha_inner_v2 file_captcha_inner_v2_locked")}}function wfu_unlock_upload(e){var a=document.getElementById("fileName_"+e);a&&(a.disabled=!1),document.getElementById("input_"+e).disabled=!1,document.getElementById("upfile_"+e).disabled=!1,wfu_selectsubdir_disable_onoff(e,!1);var t=document.getElementById("upload_"+e);t&&(t.disabled=!1);for(var s=wfu_get_userdata_count(e),l=0;s>l;l++)window["userdata_"+e+"_codes_"+l].unlock(document.getElementById("userdata_"+e+"_field_"+l));var r=document.getElementById("captcha_"+e);if(r){var n=document.getElementById("captcha_"+e+"_input"),o=document.getElementById("captcha_"+e+"_empty_overlay");n&&(document.getElementById("captcha_"+e+"_loading").className="file_captcha_overlay_hidden",n.disabled=!1),o&&(wfu_send_captcha_reset_command(e),o.parentNode.className="file_captcha_inner_v2")}}function wfu_clear_files(e){document.getElementById("uploadform_"+e).reset();var a=document.getElementById("fileName_"+e);a&&(a.value="",a.className="file_input_textbox"),wfu_filelist_clear(e)}function wfu_clear(e){wfu_clear_files(e);var a=document.getElementById("selectsubdir_"+e);if(a){var t=document.getElementById("selectsubdiredit_"+e),s="none"!=t.style.display;s?(a.selectedIndex=-1,t.value=""):a.selectedIndex=parseInt(document.getElementById("selectsubdirdefault_"+e).value)}for(var l=wfu_get_userdata_count(e),r=0;l>r;r++)window["userdata_"+e+"_codes_"+r].reset(document.getElementById("userdata_"+e+"_field_"+r),document.getElementById("hiddeninput_"+e+"_userdata_"+r));var n=document.getElementById("filelist_"+e+"_totalprogress_animation");n&&(n.style.width="0%",n.className="file_filelist_totalprogress_noanimation");var o=document.getElementById("captcha_"+e);if(o){document.getElementById("captchainput_"+e).value="";var i=document.getElementById("captcha_"+e+"_input");i&&(i.value="",i.className="file_captcha_input")}}function wfu_reset_message(e){var a=document.getElementById("wfu_messageblock_"+e);if(a){document.getElementById("wfu_messageblock_header_"+e).style.display="";var t=document.getElementById("wfu_messageblock_header_"+e+"_container");UploadStates[e]&&(t.innerHTML=UploadStates[e].State0),document.getElementById("wfu_messageblock_header_"+e+"_state").value="none",document.getElementById("wfu_messageblock_arrow_"+e).style.display="none",t.colSpan=3,document.getElementById("wfu_messageblock_subheader_"+e+"_messagelabel").innerHTML="",document.getElementById("wfu_messageblock_subheader_"+e+"_adminmessagelabel").innerHTML="",document.getElementById("wfu_messageblock_subheader_"+e).style.display="none",document.getElementById("wfu_messageblock_subheader_"+e+"_message").style.display="none",document.getElementById("wfu_messageblock_subheader_"+e+"_adminmessage").style.display="none";
for(var s=wfu_get_file_ids(e),l=1;l<=s.length;l++)a.tBodies[0].removeChild(document.getElementById("wfu_messageblock_"+e+"_"+l)),a.tBodies[0].removeChild(document.getElementById("wfu_messageblock_subheader_"+e+"_"+l))}}function wfu_show_simple_progressbar(e,a){var t=document.getElementById("progressbar_"+e+"_animation"),s=document.getElementById("progressbar_"+e+"_imagesafe");t&&("progressive"==a?(t.style.width="0%",t.className="file_progress_progressive",s.style.display="none",t.style.display="block"):wfu_BrowserCaps.supportsAnimation?(t.style.width="25%",t.className="file_progress_shuffle",s.style.display="none",t.style.display="block"):(t.style.width="0%",t.className="file_progress_noanimation",t.style.display="none",s.style.display="block"),document.getElementById("wordpress_file_upload_progressbar_"+e).style.display="block")}function wfu_hide_simple_progressbar(e){var a=document.getElementById("progressbar_"+e+"_animation"),t=document.getElementById("progressbar_"+e+"_imagesafe");a&&(document.getElementById("wordpress_file_upload_progressbar_"+e).style.display="none",a.style.width="0%",a.className="file_progress_noanimation",t.style.display="none",a.style.display="block")}function wfu_Attach_DragDrop_Events(e,a){function t(a){a=a||window.event,a.preventDefault&&a.preventDefault();var t=document.getElementById("wordpress_file_upload_drag_"+e);return"file_drag_target_over"!=t.className&&(t.className="file_drag_target_over"),!1}if(wfu_BrowserCaps.supportsDRAGDROP){var s=document.getElementById("wordpress_file_upload_drag_"+e);wfu_addEventHandler(s,"dragleave",function(a){a=a||window.event,a.preventDefault&&a.preventDefault(),document.getElementById("wordpress_file_upload_drag_"+e).className="file_drag_target"}),wfu_addEventHandler(s,"dragenter",t),wfu_addEventHandler(s,"dragover",t),wfu_addEventHandler(s,"drop",function(t){t=t||window.event,t.preventDefault&&t.preventDefault();{var s=t.dataTransfer;s.files}return wfu_selectfiles_fromdrag(e,s.files,a),!1}),wfu_addEventHandler(window,"dragenter",function(a){a=a||window.event,a.preventDefault&&a.preventDefault(),wfu_selectbutton_clicked(e),document.getElementById("wordpress_file_upload_drag_"+e).style.display=""}),wfu_addEventHandler(window,"dragleave",function(a){a=a||window.event,a.preventDefault&&a.preventDefault(),0==a.x&&0==a.y&&(document.getElementById("wordpress_file_upload_drag_"+e).style.display="none")}),wfu_addEventHandler(window,"drop",function(a){a=a||window.event,a.preventDefault&&a.preventDefault(),document.getElementById("wordpress_file_upload_drag_"+e).style.display="none"})}}function wfu_selectfiles_fromdrag(e,a,t){if(wfu_BrowserCaps.supportsAJAX&&wfu_BrowserCaps.supportsHTML5&&wfu_BrowserCaps.supportsDRAGDROP&&0!=a.length){var s=document.getElementById("upfile_"+e);if("undefined"==typeof s.filearray&&(s.filearray=Array(),s.filearrayprops=Array()),"true"==t)for(var l=0;l<a.length;l++)s.filearray.push(a[l]),s.filearrayprops.push({from:"dragdrop"});else document.getElementById("uploadform_"+e).reset(),s.filearray.length=0,s.filearrayprops.length=0,s.filearray.push(a[0]),s.filearrayprops.push({from:"dragdrop"});wfu_update_filelist(e),wfu_update_filename_text(e);var r=document.getElementById("upload_"+e);if(r)wfu_update_uploadbutton_status(e);else{var n=""+s.onchange;n=n.substr(n.indexOf("wfu_HTML5UploadFile(")),n=n.substr(0,n.indexOf(")")+1)+";";var o=new Function(n);o()}}}function wfu_lock_progressbar(e){var a=document.getElementById("filelist_"+e+"_totalprogress_animation"),t=document.getElementById("filelist_"+e+"_totalprogress_imagesafe");if(a){a.style.width="0%",a.className="file_filelist_totalprogress_noanimation",t.style.display="none",a.style.display="block",document.getElementById("filelist_"+e+"_totalprogress_removeall").style.display="none",document.getElementById("filelist_"+e+"_totalprogress").className="file_filelist_totalprogress_div",document.getElementById("filelist_"+e+"_totalprogress_arrow").className="file_filelist_totalprogress_arrow";for(var s=wfu_get_filelist(e),l=1;l<=s.length;l++)document.getElementById("filelist_"+e+"_fileremove"+l).style.display="none",document.getElementById("filelist_"+e+"_file"+l).className="file_filelist_file_div",document.getElementById("filelist_"+e+"_fileprogress_td"+l).style.display="none"}}function wfu_lockrun_progressbar(e,a){var t=document.getElementById("filelist_"+e+"_totalprogress_animation"),s=document.getElementById("filelist_"+e+"_totalprogress_imagesafe");if(t){"progressive"==a?(t.style.width="0%",t.className="file_filelist_totalprogress_progressive",s.style.display="none",t.style.display="block"):wfu_BrowserCaps.supportsAnimation?(t.style.width="25%",t.className="file_filelist_totalprogress_shuffle",s.style.display="none",t.style.display="block"):(t.style.width="0%",t.className="file_filelist_totalprogress_noanimation",t.style.display="none",s.style.display="block"),document.getElementById("filelist_"+e+"_totalprogress_removeall").style.display="none",document.getElementById("filelist_"+e+"_totalprogress").className="file_filelist_totalprogress_div",document.getElementById("filelist_"+e+"_totalprogress_arrow").className="file_filelist_totalprogress_arrow";for(var l=wfu_get_filelist(e),r=1;r<=l.length;r++)t=document.getElementById("filelist_"+e+"_fileprogress_animation"+r),document.getElementById("filelist_"+e+"_fileremove"+r).style.display="none",document.getElementById("filelist_"+e+"_file"+r).className="file_filelist_file_div","progressive"==a&&(document.getElementById("filelist_"+e+"_fileprogress_td"+r).style.display="",t.style.width="0%",t.className="file_filelist_fileprogress_progressive")}}function wfu_unlock_progressbar(e){var a=document.getElementById("filelist_"+e+"_totalprogress_animation"),t=document.getElementById("filelist_"+e+"_totalprogress_imagesafe");if(a){a.style.width="0%",a.className="file_filelist_totalprogress_noanimation",t.style.display="none",a.style.display="block";var s=document.getElementById("upfile_"+e),l=wfu_get_filelist(e,!1);if("undefined"==typeof s.filearray)document.getElementById("filelist_"+e+"_totalprogress_arrow").className="file_filelist_totalprogress_arrow_with_remove",document.getElementById("filelist_"+e+"_totalprogress").className="file_filelist_totalprogress_div_with_remove",document.getElementById("filelist_"+e+"_totalprogress_removeall").style.display="";else{l=s.filearray;for(var r=1;r<=l.length;r++)document.getElementById("filelist_"+e+"_file"+r).className="file_filelist_file_div_with_remove",document.getElementById("filelist_"+e+"_fileremove"+r).style.display="",document.getElementById("filelist_"+e+"_fileprogress_td"+r).style.display="none"}}}function wfu_invoke_shortcode_editor(e,a,t,s){for(var l=document.getElementsByTagName("BUTTON"),r=0,n=null,o=0;o<l.length;o++)l[o].parentNode&&l[o].parentNode.id==s+"_editor_"+e&&(n=l[o],r++);if(0!=r){if(r>1)return void alert(GlobalData.consts.same_pluginid);var i=wfu_GetHttpRequestObject();if(null!=i){n.parentNode.style.display="none",document.getElementById(s+"_overlay_"+e).style.display="block";var _=GlobalData.consts.ajax_url;params=new Array(6),params[0]=new Array(2),params[0][0]="action",params[0][1]="wfu_ajax_action_edit_shortcode",params[1]=new Array(2),params[1][0]="upload_id",params[1][1]=e,params[2]=new Array(2),params[2][0]="post_id",params[2][1]=a,params[3]=new Array(2),params[3][0]="post_hash",params[3][1]=t,params[4]=new Array(2),params[4][0]="shortcode_tag",params[4][1]=s,params[5]=new Array(2),params[5][0]="widget_id",params[5][1]=document.getElementById(s+"_"+e+"_widgetid")?document.getElementById(s+"_"+e+"_widgetid").value:"";for(var d="",o=0;o<params.length;o++)d+=(o>0?"&":"")+params[o][0]+"="+encodeURI(params[o][1]);i.open("POST",_,!0),i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.onreadystatechange=function(){if(4==i.readyState&&200==i.status){document.getElementById(s+"_overlay_"+e).style.display="none",n.parentNode.removeAttribute("style");var a="wfu_edit_shortcode:",t=i.responseText.indexOf(a);-1==t&&(t=i.responseText.length);var l=(i.responseText.substr(0,t),i.responseText.substr(t+a.length,i.responseText.length-t-a.length));t=l.indexOf(":");var r=l.substr(0,t);if(txt_value=l.substr(t+1,l.length-t-1),"success"==r){var o=window.open(wfu_plugin_decode_string(txt_value),"_blank");o?o.plugin_window=window:alert(GlobalData.consts.enable_popups)}else"check_page_obsolete"==r&&alert(txt_value)}},i.send(d)}}}function wfu_browser_mouseover(e,a){var t=document.querySelectorAll("tr.wfu_browser_tr.wfu_browser-"+e+" .wfu_actions");if(0!=t.length){for(var s in t)t.item(s).style.visibility="hidden";var l=document.querySelector("tr.wfu_browser_tr.wfu_browser-"+e+".wfu_row-"+a+" .wfu_actions");l&&(l.style.visibility="visible")}}function wfu_browser_mouseout(e){var a=document.querySelectorAll("tr.wfu_browser_tr.wfu_browser-"+e+" .wfu_actions");if(0!=a.length)for(var t in a)a.item(t).style.visibility="hidden"}function wfu_get_browser_fileprops(e){for(var a=[],t=document.querySelectorAll(".wfu_browser-"+e+"_columns"),s=0;s<t.length;s++){var l=document.querySelectorAll("tr.wfu_browser_tr.wfu_browser-"+e+" .wfu_data_"+t[s].value);if(l.length>a.length)for(var r=0;r<l.length;r++)a[r]={};for(var r=0;r<l.length;r++)a[r][t[s].value]=l[r].value;for(var n=document.querySelectorAll("tr.wfu_browser_tr.wfu_browser-"+e+" .wfu_data_"+t[s].value+"_sort"),r=0;r<n.length;r++)a[r][t[s].value+"_sort"]=n[r].value}for(var o=document.querySelectorAll("tr.wfu_browser_tr.wfu_browser-"+e+" .wfu_data_file_code"),r=0;r<o.length;r++)a[r].file_code=o[r].value;return a}function wfu_browser_apply_fileprops(e,a){var t=document.querySelector("table.wfu_browser_table.wfu_browser-"+e);if(t){for(var s,l,r,n,o,i=document.querySelectorAll(".wfu_browser-"+e+"_columns"),_=t.tBodies[0].rows,d=0;d<a.length;d++){s=d+1,_.length<s+1&&wfu_browser_addrow(e);for(var u=0;u<i.length;u++)l=i[u].value,r=document.querySelector("tr.wfu_browser_tr.wfu_browser-"+e+".wfu_row-"+s+" .wfu_display_"+l),n=document.querySelector("tr.wfu_browser_tr.wfu_browser-"+e+".wfu_row-"+s+" .wfu_data_"+l),o=document.querySelector("tr.wfu_browser_tr.wfu_browser-"+e+".wfu_row-"+s+" .wfu_data_"+l+"_sort"),file_code=document.querySelector("tr.wfu_browser_tr.wfu_browser-"+e+".wfu_row-"+s+" .wfu_data_file_code"),r.innerHTML="inc"==l?s:"fields"==l?wfu_plugin_decode_string(a[d][l]):a[d][l],n.value=a[d][l],o&&(o.value=a[d][l+"_sort"]),file_code.value=a[d].file_code}for(;_.length>a.length+1;)t.deleteRow(t.rows.length-1)}}function wfu_browser_addrow(e){var a=document.querySelector("table.wfu_browser_table.wfu_browser-"+e);if(a){var t=a.tBodies[0].rows,s=t[0].cloneNode(!0);s.className="wfu_browser_tr wfu_row-"+t.length+" wfu_browser-"+e,s.onmouseover=new Function("event","wfu_browser_mouseover("+e+", "+t.length+");"),s.onmouseout=new Function("event","wfu_browser_mouseout("+e+");"),a.tBodies[0].appendChild(s)}}function wfu_sort_fileprops(e,a,t,s){for(var l,r,n=0;n<s.length-1;n++)for(var o=n+1;o<s.length;o++)if("s"==a?(l=s[o][e+"_sort"],r=s[n][e+"_sort"]):"n"==a&&(l=parseInt(s[o][e+"_sort"]),r=parseInt(s[n][e+"_sort"])),t&&r>l||!t&&l>r){var i=s[n];s[n]=s[o],s[o]=i}return s}function wfu_browser_sort(e,a,t){var s=wfu_get_browser_fileprops(e),l=document.getElementById("wfu_browser-"+e+"_sort").value.replace(/:.*$/,""),r=l!=a;s=wfu_sort_fileprops(a,t,r,s),document.getElementById("wfu_browser-"+e+"_sort").value=(r?"":"-")+a+":"+t,wfu_browser_apply_fileprops(e,s)}function wfu_browser_add_file(e,a){var t=wfu_get_browser_fileprops(e),s=document.querySelectorAll(".wfu_browser-"+e+"_columns"),l=t.length;t[l]={};for(var r=0;r<s.length;r++)t[l][s[r].value]=a[s[r].value],a[s[r].value+"_sort"]&&(t[l][s[r].value+"_sort"]=a[s[r].value+"_sort"]);t[l].file_code=a.file_code;var n=document.getElementById("wfu_browser-"+e+"_sort").value.replace(/:.*$/,""),o=document.getElementById("wfu_browser-"+e+"_sort").value.replace(/^.*:/,""),i="-"!=n.substr(0,1);i||(n=n.substr(1)),t=wfu_sort_fileprops(n,o,i,t),wfu_browser_apply_fileprops(e,t)}function wfu_browser_delete_file(e,a){var t=wfu_get_browser_fileprops(e);t.splice(a-1,1),wfu_browser_apply_fileprops(e,t)}function wfu_download_file_frontend(e){for(;e&&"tr"!=e.tagName.toLowerCase();)e=e.parentNode;if(!e)return!1;var a=e.className.replace(/.*wfu_browser-/,""),t=e.className.replace(/.*wfu_row-/,"").replace(/ wfu_browser-.*/,""),s=document.querySelector("tr.wfu_browser_tr.wfu_browser-"+a+".wfu_row-"+t+" .wfu_data_file_code").value,l=wfu_GetHttpRequestObject();if(null!=l){var r=GlobalData.consts.ajax_url;params=new Array(3),params[0]=new Array(2),params[0][0]="action",params[0][1]="wfu_ajax_action_download_file_invoker",params[1]=new Array(2),params[1][0]="file",params[1][1]=s,params[2]=new Array(2),params[2][0]="nonce",params[2][1]=document.getElementById("wfu_browser_nonce_"+a).value,params[3]=new Array(2),params[3][0]="browser",params[3][1]=document.getElementById("wfu_browser_code_"+a).value;for(var n="",o=0;o<params.length;o++)n+=(o>0?"&":"")+params[o][0]+"="+encodeURI(params[o][1]);l.open("POST",r,!0),l.setRequestHeader("Content-type","application/x-www-form-urlencoded"),l.onreadystatechange=function(){if(4==l.readyState&&200==l.status){var e="wfu_ajax_action_download_file_invoker:",r=l.responseText.indexOf(e);-1==r&&(r=l.responseText.length);var n=(l.responseText.substr(0,r),l.responseText.substr(r+e.length,l.responseText.length-r-e.length));r=n.indexOf(":");var o=n.substr(0,r);if(txt_value=n.substr(r+1,n.length-r-1),"wfu_download_id;"==o.substr(0,16)){var i=o.substr(16),_=document.querySelector("tr.wfu_browser_tr.wfu_browser-"+a+".wfu_row-"+t+" .wfu_file_download_container");_.innerHTML=txt_value,setTimeout("wfu_download_file_monitor_frontend('"+s+"', "+a+", "+t+", '"+i+"')",100)}}},l.send(n)}}function wfu_download_file_monitor_frontend(e,a,t,s){var l=wfu_GetHttpRequestObject();if(null!=l){var r=GlobalData.consts.ajax_url;params=new Array(3),params[0]=new Array(2),params[0][0]="action",params[0][1]="wfu_ajax_action_download_file_monitor",params[1]=new Array(2),params[1][0]="file",params[1][1]=e,params[2]=new Array(2),params[2][0]="id",params[2][1]=s;for(var n="",o=0;o<params.length;o++)n+=(o>0?"&":"")+params[o][0]+"="+encodeURI(params[o][1]);l.open("POST",r,!0),l.setRequestHeader("Content-type","application/x-www-form-urlencoded"),l.onreadystatechange=function(){if(4==l.readyState&&200==l.status){var s="wfu_ajax_action_download_file_monitor:",r=l.responseText.indexOf(s);-1==r&&(r=l.responseText.length);var n=(l.responseText.substr(0,r),l.responseText.substr(r+s.length,l.responseText.length-r-s.length));r=n.indexOf(":");var o=n.substr(0,r);if(txt_value=n.substr(r+1,n.length-r-1),"repeat"!=o){var i=document.querySelector("tr.wfu_browser_tr.wfu_browser-"+a+".wfu_row-"+t+" .wfu_file_download_container");i.innerHTML=""}else"repeat"==o&&setTimeout("wfu_download_file_monitor('"+e+"', "+a+", "+t+", '"+txt_value+"')",100)}},l.send(n)}}function wfu_delete_file_frontend(e){for(;e&&"tr"!=e.tagName.toLowerCase();)e=e.parentNode;if(!e)return!1;if(!confirm(GlobalData.consts.wfu_browser_deletefile_prompt))return!1;var a=e.className.replace(/.*wfu_browser-/,""),t=e.className.replace(/.*wfu_row-/,"").replace(/ wfu_browser-.*/,""),s=document.querySelector("tr.wfu_browser_tr.wfu_browser-"+a+".wfu_row-"+t+" .wfu_data_file_code").value,l=wfu_GetHttpRequestObject();if(null!=l){var r=GlobalData.consts.ajax_url;params=new Array(3),params[0]=new Array(2),params[0][0]="action",params[0][1]="wfu_ajax_action_delete_file",params[1]=new Array(2),params[1][0]="file",params[1][1]=s,params[2]=new Array(2),params[2][0]="nonce",params[2][1]=document.getElementById("wfu_browser_nonce_"+a).value,params[3]=new Array(2),params[3][0]="browser",params[3][1]=document.getElementById("wfu_browser_code_"+a).value;for(var n="",o=0;o<params.length;o++)n+=(o>0?"&":"")+params[o][0]+"="+encodeURI(params[o][1]);l.open("POST",r,!0),l.setRequestHeader("Content-type","application/x-www-form-urlencoded"),l.onreadystatechange=function(){if(4==l.readyState&&200==l.status){var e="wfu_ajax_action_delete_file:",s=l.responseText.indexOf(e);-1==s&&(s=l.responseText.length);var r=(l.responseText.substr(0,s),l.responseText.substr(s+e.length,l.responseText.length-s-e.length));s=r.indexOf(":");var n=r.substr(0,s);txt_value=r.substr(s+1,r.length-s-1),"success"==n?wfu_browser_delete_file(a,t):"not_allowed"==n&&(txt_value=txt_value.trim(),""!=txt_value&&alert(txt_value))}},l.send(n)}}GlobalData={},UploadStates={},GlobalData.filestatematch={},GlobalData.filestatematch.success=[0,1,2,2],GlobalData.filestatematch.warning=[1,1,2,2],GlobalData.filestatematch.error1=[3,3,2,3],GlobalData.filestatematch.error2=[2,2,2,3],GlobalData.UploadInProgressString="",GlobalData.FreeChangeHandler=!1,wfu_Check_Browser_Capabilities();